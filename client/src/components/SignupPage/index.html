<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="../../libs/bootstrap/css/bootstrap.min.css">

    <title>SNE</title>
</head>
<body>
    <div class='container-fluid p-3'>
        <div class='w-100 row justify-content-center alert-box'></div>
        <div class="row px-2 py-3 position-absolute start-50 top-50 translate-middle border box-width rounded-custom">
            <div class="col-12">
                <h3>Đăng ký</h3>
                <p class="text-secondary">Nhanh chóng và dễ dàng.</p>
            </div>
            <div class="col-12 border"></div>
            <form class="col-12 py-3">
                <div class="row g-3">
                    <div class="col-lg-6 col-12">
                      <input type="text" id="fname" class="form-control" placeholder="Họ">
                    </div>
                    <div class="col-lg-6 col-12">
                      <input type="text" id="lname" class="form-control" placeholder="Tên">
                    </div>
                    <div class="col-12 input-group">
                        <div class="input-group-text">@</div>
                        <input type="email" id="email" class="form-control" placeholder="Email">
                    </div>
                    <div class="col-12">
                        <input type="password" id="password" class="form-control" placeholder="Mật khẩu">
                    </div>
                    <div class="col-12 text-secondary">
                        <label>Ngày sinh <i class=" fas fa-question-circle"></i></label>
                        <div class="row">
                            <div class="col">
                                <select id="day" class="form-select">
                                    <option selected value="">Ngày</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">14</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                </select>
                            </div>
                            <div class="col">
                                <select id="month" class="form-select">
                                    <option selected value="">Tháng</option>
                                    <option value="JAN">Tháng 1</option>
                                    <option value="FEB">Tháng 2</option>
                                    <option value="MAR">Tháng 3</option>
                                    <option value="APR">Tháng 4</option>
                                    <option value="MAY">Tháng 5</option>
                                    <option value="JUN">Tháng 6</option>
                                    <option value="JUL">Tháng 7</option>
                                    <option value="AUG">Tháng 8</option>
                                    <option value="SEP">Tháng 9</option>
                                    <option value="OCT">Tháng 10</option>
                                    <option value="NOV">Tháng 11</option>
                                    <option value="DEC">Tháng 12</option>
                                </select>
                            </div>
                            <div class="col">
                                <select id="year" class="form-select">
                                    <option selected value="">Năm</option>
                                    <option value="2003">2003</option>
                                    <option value="2002">2002</option>
                                    <option value="2001">2001</option>
                                    <option value="2000">2000</option>
                                    <option value="1999">1999</option>
                                    <option value="1998">1998</option>
                                    <option value="1997">1997</option>
                                    <option value="1996">1996</option>
                                    <option value="1995">1995</option>
                                    <option value="1994">1994</option>
                                    <option value="1993">1993</option>
                                    <option value="1992">1992</option>
                                    <option value="1991">1991</option>
                                    <option value="1990">1990</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-12  text-secondary">
                        <label>Giới tính <i class=" fas fa-question-circle"></i></label>
                        <div class="row">
                            <div class="col position-relative">
                                <label class="form-control">Nam</label>
                                <input type="radio" name="gender" value="Male" class="position-absolute m-0 form-check-input radio-custom">
                            </div>
                            <div class="col position-relative">
                                <label class="form-control">Nữ</label>
                                <input type="radio" name="gender" value="Female" class="position-absolute m-0 form-check-input radio-custom">
                            </div>
                            <div class="col position-relative">
                                <label class="form-control">Tùy chọn</label>
                                <input type="radio" name="gender" value="Option" class="position-absolute m-0 form-check-input radio-custom">
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <p class="text-secondary m-0 fs-custom">
                            Bằng cách nhấp vào Đăng ký, 
                            bạn đồng ý với <a href="#">Điều khoản</a>, 
                            <a href="#">Chính sách dữ liệu</a> 
                            và <a href="#">Chính sách cookie</a> của chúng tôi. Bạn có thể nhận được thông báo của chúng tôi qua SMS và hủy nhận bất kỳ lúc nào.
                        </p>
                    </div>
                    <div class="col-12">
                        <button type="button" class="w-100 btn btn-success" id="signup-btn">Đăng ký</button>
                    </div>
                    <div class="col-12 border"></div>
                    <div class="col-12">
                        <button type="button" class="w-100 btn btn-primary" id="login-btn">Đăng nhập</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script src="https://kit.fontawesome.com/6184c439ae.js" crossorigin="anonymous"></script>
    <script src="../../libs/jquery/jquery-3.5.1.js"></script>
    <script src="../../libs/bootstrap/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(()=>{
            $('#signup-btn').click(()=>{
                const fname = $('#fname').val()
                const lname = $('#lname').val()
                const email = $('#email').val().toLowerCase()
                const password = $('#password').val()
                const birthDay = `${$('#day').val()}-${$('#month').val()}-${$('#year').val()}`
                const gender = $('input[name=gender]:checked').val()

                console.log(gender);

                if(!fname){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa nhập họ.
                        </div>
                    `)
                    return
                }
                if(!lname){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa nhập tên.
                        </div>
                    `)
                    return
                }
                if(!email){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa nhập email.
                        </div>
                    `)
                    return
                }
                if(!password){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa nhập mật khẩu.
                        </div>
                    `)
                    return
                }
                if(!$('#day').val() || !$('#month').val() || !$('#year').val()){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa nhập đủ ngày tháng năm sinh.
                        </div>
                    `)
                    return
                }
                if(!gender){
                    $('.alert').remove()
                    $('.alert-box').prepend(`
                        <div class="alert alert-warning w-75 postion-absolute rounded" role="alert">
                            Bạn chưa chọn giới tính.
                        </div>
                    `)
                    return
                }

                $.ajax({
                    url: 'http://localhost:3000/users',
                    type: 'POST',
                    data: JSON.stringify({
                        fname,
                        lname,
                        email,
                        password,
                        birthDay,
                        gender,
                        avatar: 'https://www.minervastrategies.com/wp-content/uploads/2016/03/default-avatar.jpg'
                    }),
                    contentType: 'application/json'
                }).done(data => {
                    if(data.status === 200){
                        $('.alert').remove()
                        $('.alert-box').prepend(`
                            <div class="alert alert-success w-75 postion-absolute rounded" role="alert">
                                Đăng ký thành công.
                            </div>
                        `)

                        setTimeout(()=>{
                            window.location.replace('../LoginPage/index.html')
                        }, 500)
                    } else{
                        $('.alert').remove()
                        $('.alert-box').prepend(`
                            <div class="alert alert-danger w-75 postion-absolute rounded" role="alert">
                                ${data.message}
                            </div>
                        `)
                    }
                })
            })

            $('#login-btn').click(()=>{
                window.location.replace('../LoginPage/index.html')
            })
        })
    </script>
</body>
</html>